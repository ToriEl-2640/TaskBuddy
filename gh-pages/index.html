<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TaskBuddy - Static & Fully Functional</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
  body {
    margin: 0; padding: 0;
    font-family: 'Roboto', sans-serif;
    background-size: cover;
    background-position: center;
    min-height: 100vh;
    color: #222;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 2rem;
    background-image: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1470&q=80');
    transition: background-image 0.5s ease-in-out;
  }
  .overlay {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(255 255 255 / 0.8);
    backdrop-filter: blur(10px);
    z-index: -1;
  }
  .container {
    background: rgba(255 255 255 / 0.85);
    padding: 2rem 2.5rem;
    border-radius: 15px;
    max-width: 400px;
    width: 100%;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
  }
  h1 {
    margin-top: 0;
    margin-bottom: 1.2rem;
    text-align: center;
    color: #333;
  }
  ul {
    list-style: none;
    padding-left: 0;
    margin-bottom: 1rem;
    max-height: 300px;
    overflow-y: auto;
  }
  li {
    background: #1976d2;
    color: white;
    padding: 0.6rem 1rem;
    margin-bottom: 0.6rem;
    border-radius: 10px;
    display: flex;
    align-items: center;
    cursor: pointer;
    user-select: none;
  }
  li.done {
    background: #a0a0a0;
    text-decoration: line-through;
    color: #eee;
  }
  li input[type="checkbox"] {
    margin-right: 1rem;
    width: 20px;
    height: 20px;
    cursor: pointer;
  }
  form {
    display: flex;
    gap: 0.7rem;
  }
  input[type="text"] {
    flex: 1;
    padding: 0.6rem 1rem;
    border: 2px solid #1976d2;
    border-radius: 10px;
    font-size: 1rem;
  }
  button {
    background: #1976d2;
    border: none;
    padding: 0 1.5rem;
    border-radius: 10px;
    color: white;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  button:hover {
    background: #0d47a1;
  }
  .bg-selector {
    margin-top: 1rem;
    text-align: center;
  }
  .bg-selector button {
    margin: 0 0.2rem;
    width: 40px;
    height: 30px;
    border-radius: 6px;
    border: 2px solid #1976d2;
    background-size: cover;
    cursor: pointer;
    outline: none;
  }
  .bg-selector button.active {
    border-color: #0d47a1;
    box-shadow: 0 0 8px #0d47a1;
  }
</style>
</head>
<body>
  <div class="overlay"></div>
  <div class="container">
    <h1>TaskBuddy</h1>
    <ul id="task-list"></ul>
    <form id="add-task-form">
      <input type="text" id="new-task-input" placeholder="Add new task..." autocomplete="off" required />
      <button type="submit">Add</button>
    </form>
    <div class="bg-selector" aria-label="Select background">
      <!-- Background buttons will be added here by JS -->
    </div>
  </div>

<script>
  const tasksKey = 'taskbuddy_tasks';
  const bgKey = 'taskbuddy_bgIndex';

  // Default tasks if none in storage
  let tasks = JSON.parse(localStorage.getItem(tasksKey)) || [
    { title: "Learn Python", done: false },
    { title: "Write and publish a book by next week", done: false }
  ];

  // Background images array
  const backgrounds = [
    'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1470&q=80',
    'https://images.unsplash.com/photo-1500534623283-312aade485b7?auto=format&fit=crop&w=1470&q=80',
    'https://images.unsplash.com/photo-1468071174046-657d9d351a40?auto=format&fit=crop&w=1470&q=80',
    'https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=1470&q=80',
    'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1470&q=80',
    'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1470&q=80',
    'https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=1470&q=80',
    'https://images.unsplash.com/photo-1470770841072-f978cf4d019e?auto=format&fit=crop&w=1470&q=80',
    'https://images.unsplash.com/photo-1501594907352-04cda38ebc29?auto=format&fit=crop&w=1470&q=80',
    'https://images.unsplash.com/photo-1465101162946-4377e57745c3?auto=format&fit=crop&w=1470&q=80'
  ];

  // Elements
  const taskList = document.getElementById('task-list');
  const addTaskForm = document.getElementById('add-task-form');
  const newTaskInput = document.getElementById('new-task-input');
  const bgSelector = document.querySelector('.bg-selector');
  const body = document.body;

  // Load background index from localStorage or default 0
  let currentBgIndex = parseInt(localStorage.getItem(bgKey)) || 0;
  setBackground(currentBgIndex);

  // Render background buttons
  backgrounds.forEach((url, idx) => {
    const btn = document.createElement('button');
    btn.style.backgroundImage = `url(${url})`;
    btn.title = `Background ${idx + 1}`;
    btn.setAttribute('aria-label', `Select background ${idx + 1}`);
    if (idx === currentBgIndex) btn.classList.add('active');
    btn.addEventListener('click', () => {
      setBackground(idx);
    });
    bgSelector.appendChild(btn);
  });

  // Set background image and save preference
  function setBackground(index) {
    currentBgIndex = index;
    body.style.backgroundImage = `url(${backgrounds[index]})`;
    localStorage.setItem(bgKey, index);
    document.querySelectorAll('.bg-selector button').forEach((btn, idx) => {
      btn.classList.toggle('active', idx === index);
    });
  }

  // Render tasks on page
  function renderTasks() {
    taskList.innerHTML = '';
    tasks.forEach((task, idx) => {
      const li = document.createElement('li');
      li.className = task.done ? 'done' : '';
      // Checkbox
      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.checked = task.done;
      checkbox.addEventListener('change', () => {
        tasks[idx].done = checkbox.checked;
        saveTasks();
        renderTasks();
      });
      li.appendChild(checkbox);
      // Task text
      const span = document.createElement('span');
      span.textContent = task.title;
      li.appendChild(span);

      taskList.appendChild(li);
    });
  }

  // Save tasks to localStorage
  function saveTasks() {
    localStorage.setItem(tasksKey, JSON.stringify(tasks));
  }

  // Add new task handler
  addTaskForm.addEventListener('submit', e => {
    e.preventDefault();
    const text = newTaskInput.value.trim();
    if (text) {
      tasks.push({ title: text, done: false });
      saveTasks();
      renderTasks();
      newTaskInput.value = '';
    }
  });

  // Initial render
  renderTasks();
</script>
</body>
</html>
